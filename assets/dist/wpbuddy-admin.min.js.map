{"version":3,"file":"wpbuddy-admin.min.js","mappings":"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","sources":["webpack:///./assets/src/wpbuddy-admin.js"],"sourcesContent":["jQuery(document).ready(function ($) {\n  var wpbuddyPlugin = wpbuddyPlugin || {};\n  wpbuddyPlugin = {\n    textareaInititalHeight: 0,\n    init: function () {\n      this.cacheDom();\n      this.bindEvents();\n      this.runSettingsValidation();\n      this.textareaInititalHeight = this.$textarea.height();\n    },\n    cacheDom: function () {\n      this.$wpbuddyForm = $(\"#wpbuddy-form\");\n      this.$wpbuddySettingsForm = $(\"#wpbuddy-settings-form\");\n      this.$wpbuddyLicenseStatus = $(\".wpbuddy-license-status\");\n      this.$wpbuddyLicenseField = $(\"input[name='wpbuddy_license_key']\");\n      this.$wpbuddyLicenseStatusText = $(\".wpbuddy-status-text\");\n      this.$wpbuddyAdminSpinner = $(\".wpbuddy-admin-spinner\");\n      this.$wpbuddyFormSpinner = $(\".wpbuddy-form-spinner\");\n      this.$wpbuddyFormResult = $(\".wpbuddy-form-result\");\n      this.$wpbuddyFormResultSuccess = $(\".wpbuddy-form-result__success\");\n      this.$wpbuddyFormResultError = $(\".wpbuddy-form-result__error\");\n      this.$wpbuddyFormResultSuccessText = $(\n        \".wpbuddy-form-result__success__text\"\n      );\n      this.$wpbuddyFormResultClose = $(\".wpbuddy-form-result__close\");\n      this.$wpbuddyFormResultErrorText = $(\".wpbuddy-form-result__error__text\");\n      this.$wpbuddyFormClose = $(\".wpbuddy-form__close\");\n      this.$wpbuddyFooterIcon = $(\".wpbuddy-footer__icon\");\n      this.$wpbuddyFormContainer = $(\".wpbuddy-form__container\");\n      this.$textarea = $(\"#wpbuddy-form__field__description\");\n      this.$accordionHeader = $(\".wpbuddy-accordion__header\");\n    },\n    bindEvents: function () {\n      this.$wpbuddyForm.on(\"submit\", this.createTicket.bind(this));\n      this.$wpbuddyFormResultClose.on(\"click\", this.closeFormResult.bind(this));\n      this.$wpbuddyFormClose.on(\"click\", this.toggleForm.bind(this));\n      this.$wpbuddyFooterIcon.on(\"click\", this.toggleForm.bind(this));\n      this.$textarea.on(\"input\", this.textareaResize.bind(this));\n      this.$textarea.on(\"keyup\", this.textareReset.bind(this));\n      this.$accordionHeader.on(\"click\", this.toggleAccordion.bind(this));\n    },\n    runSettingsValidation: function () {\n      if (this.$wpbuddySettingsForm.length) {\n        this.validateSettings();\n      }\n    },\n    createTicket: function (e) {\n      e.preventDefault();\n      this.$wpbuddyFormSpinner.css(\"display\", \"flex\");\n      // Add nonce to the form data\n      var form_data = new FormData();\n      form_data.append(\"image\", $(\"#wpbuddy-form__field__file\")[0].files[0]);\n      form_data.append(\"title\", $(\"#wpbuddy-form__field__title\").val());\n      form_data.append(\n        \"description\",\n        $(\"#wpbuddy-form__field__description\").val()\n      );\n      form_data.append(\n        \"priority_id\",\n        $(\"#wpbuddy-form__field__priority_id\").val()\n      );\n\n      $.ajax({\n        url: `${WPBuddy.root}wpbuddy/v1/create-ticket`,\n        type: \"POST\",\n        data: form_data,\n        processData: false,\n        contentType: false,\n        beforeSend: function (xhr) {\n          xhr.setRequestHeader(\"X-WP-Nonce\", WPBuddy.nonce);\n        },\n        success: function (response) {\n          if (response && response.success) {\n            this.$wpbuddyForm[0].reset();\n            this.$textarea.attr(\"rows\", 1);\n            this.$wpbuddyFormResult.css(\"display\", \"flex\");\n            this.$wpbuddyFormResultSuccess.css(\"display\", \"block\");\n            this.$wpbuddyFormContainer.removeClass(\n              \"wpbuddy-form__container--error\"\n            );\n            this.$wpbuddyFormContainer.addClass(\n              \"wpbuddy-form__container--success\"\n            );\n            this.$wpbuddyFormResultErrorText.html(\"\");\n            $ticket_url = response.data.ticket_url;\n            this.$wpbuddyFormResultSuccessText.html(\n              `<p>Thank you for contacting us. Your ticket has been created. You can view it <a href=\"${$ticket_url}\" target=\"_blank\">here</a></p>`\n            );\n          }\n          if (response && !response.success) {\n            this.$wpbuddyFormResult.css(\"display\", \"flex\");\n            this.$wpbuddyFormResultError.css(\"display\", \"block\");\n            this.$wpbuddyFormContainer.removeClass(\n              \"wpbuddy-form__container--success\"\n            );\n            this.$wpbuddyFormContainer.addClass(\n              \"wpbuddy-form__container--error\"\n            );\n            this.$wpbuddyFormResultSuccessText.html(\"\");\n            this.$wpbuddyFormResultErrorText.html(response.message);\n            const errors = response.data?.errors;\n            for (const property in errors) {\n              $(`#wpbuddy-form__field__${property}`).addClass(\n                \"wpbuddy-form__field--error\"\n              );\n              $(`.wpbuddy-form__field__${property}__error`).html(\n                errors[property]\n              );\n            }\n          }\n          this.$wpbuddyFormSpinner.css(\"display\", \"none\");\n        }.bind(this),\n        error: function (error) {\n          console.log(error);\n        },\n      });\n    },\n    closeFormResult: function () {\n      this.$wpbuddyFormResult.css(\"display\", \"none\");\n      this.$wpbuddyFormResultSuccess.css(\"display\", \"none\");\n      this.$wpbuddyFormResultError.css(\"display\", \"none\");\n      this.$wpbuddyFormContainer.removeClass(\n        \"wpbuddy-form__container--success\"\n      );\n      this.$wpbuddyFormContainer.removeClass(\"wpbuddy-form__container--error\");\n    },\n    closeForm: function () {\n      this.$wpbuddyFormResult.css(\"display\", \"none\");\n      this.$wpbuddyFormResultSuccess.css(\"display\", \"none\");\n      this.$wpbuddyFormResultError.css(\"display\", \"none\");\n      this.$wpbuddyFormContainer.removeClass(\n        \"wpbuddy-form__container--success\"\n      );\n      this.$wpbuddyFormContainer.removeClass(\"wpbuddy-form__container--error\");\n      this.$wpbuddyFormContainer.css(\"display\", \"none\");\n    },\n    toggleForm: function (e) {\n      e.preventDefault();\n      this.$wpbuddyFormContainer.toggle();\n    },\n    textareaResize: function () {\n      const rowHeight = parseInt(this.$textarea.css(\"line-height\"));\n      const currentHeight = this.$textarea.prop(\"scrollHeight\");\n      if (currentHeight > this.textareaInititalHeight) {\n        const rows = Math.floor(currentHeight / rowHeight);\n        this.$textarea.attr(\"rows\", rows);\n      } else if (this.$textarea.val() === \"\") {\n        this.$textarea.attr(\"rows\", 1);\n      }\n    },\n    textareReset: function () {\n      if (this.$textarea.val() === \"\") {\n        this.$textarea.attr(\"rows\", 1);\n      }\n    },\n    validateSettings: function (reload = false) {\n      var form_data = new FormData();\n      if (this.$wpbuddyLicenseField.val() == \"\") {\n        return;\n      }\n      form_data.append(\"wpbuddy_license_key\", this.$wpbuddyLicenseField.val());\n      this.$wpbuddyAdminSpinner.addClass(\"is-active\");\n      this.$wpbuddyLicenseStatusText.html(\"\");\n      $.ajax({\n        url: `${WPBuddy.root}wpbuddy/v1/validate-license`,\n        type: \"POST\",\n        data: form_data,\n        processData: false,\n        contentType: false,\n        beforeSend: function (xhr) {\n          xhr.setRequestHeader(\"X-WP-Nonce\", WPBuddy.nonce);\n        },\n        success: function (response) {\n          if (response && response.success) {\n            this.$wpbuddyLicenseStatusText.html(\n              `<p class=\"valid\">${response.message}</p>`\n            );\n            this.$wpbuddyAdminSpinner.removeClass(\"is-active\");\n            setTimeout(() => {\n              if (reload) {\n                this.$wpbuddySettingsForm[0].submit();\n              }\n            }, 200);\n          }\n          if (response && !response.success) {\n            this.$wpbuddyLicenseStatusText.html(\n              `<p class=\"invalid\">${response.message}</p>`\n            );\n            this.$wpbuddyAdminSpinner.removeClass(\"is-active\");\n          }\n        }.bind(this),\n        error: function (error) {\n          console.log(error);\n        },\n        done: function () {\n          this.$wpbuddyAdminSpinner.removeClass(\"is-active\");\n        }.bind(this),\n      });\n    },\n    toggleAccordion: function (e) {\n      e.preventDefault();\n      let _this = e.currentTarget;\n      $(_this).toggleClass(\"active\");\n\n      // Select all accordion headers except the clicked one and remove active class\n      $(_this)\n        .parent()\n        .siblings()\n        .find(\".wpbuddy-accordion__header\")\n        .removeClass(\"active\");\n      $(_this).parent().siblings().find(\".wpbuddy-accordion__body\").slideUp();\n\n      // Toggle the slide for the accordion body of the clicked header\n      $(_this).next(\".wpbuddy-accordion__body\").slideToggle();\n    },\n  };\n  wpbuddyPlugin.init();\n});\n"],"names":["jQuery","document","ready","$","wpbuddyPlugin","textareaInititalHeight","init","this","cacheDom","bindEvents","runSettingsValidation","$textarea","height","$wpbuddyForm","$wpbuddySettingsForm","$wpbuddyLicenseStatus","$wpbuddyLicenseField","$wpbuddyLicenseStatusText","$wpbuddyAdminSpinner","$wpbuddyFormSpinner","$wpbuddyFormResult","$wpbuddyFormResultSuccess","$wpbuddyFormResultError","$wpbuddyFormResultSuccessText","$wpbuddyFormResultClose","$wpbuddyFormResultErrorText","$wpbuddyFormClose","$wpbuddyFooterIcon","$wpbuddyFormContainer","$accordionHeader","on","createTicket","bind","closeFormResult","toggleForm","textareaResize","textareReset","toggleAccordion","length","validateSettings","e","preventDefault","css","form_data","FormData","append","files","val","ajax","url","concat","WPBuddy","root","type","data","processData","contentType","beforeSend","xhr","setRequestHeader","nonce","success","response","reset","attr","removeClass","addClass","html","$ticket_url","ticket_url","_response$data","message","errors","property","error","console","log","closeForm","toggle","rowHeight","parseInt","currentHeight","prop","rows","Math","floor","reload","arguments","undefined","_this2","setTimeout","submit","done","_this","currentTarget","toggleClass","parent","siblings","find","slideUp","next","slideToggle"],"sourceRoot":""}